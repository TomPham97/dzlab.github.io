---
layout: post
comments: true
title: Data Validation with TensorFlow eXtended (TFX)
description: Learn how to use TFDV to generate statistics about your data and turn them into something actionable.
categories: ml
tags: [tensorflow, tfx]
toc: true
img_excerpt:
---

![tfx-components]({{ "assets/2020/11/20201103-tfx-components.svg" | absolute_url }}){: .center-image }

In a previous [article]({{ "ml/2020/09/13/tfx-data-ingestion/" | absolute_url }}), we discussed the we can ingest data from various sources into a TFX pipeline. In this article, we will discuss the next step of a TFX pipeline which involves schema generation and data validation.

This step checks the data coming through the pipeline, and catches any changes that could impact the next steps (i.e. feature engineering and training). In TFX, this is implemented via the Tensorflow Data Validation (TFDV) Python library which can be installed with `pip`.

```sh
$ pip install tensorflow-data-validation
```

TFDV can be used for generating schemas and statistics about the distribution of every feature in the dataset. Such information is useful for comparing multiple datasets (e.g. training vs inference datasets) and reporting:
* Anomalies related to schema changes
* Statistical differences in the features distribution

TFDV also offers visualization capabilities for comparing datasets based on the Google PAIR [Facets](https://pair-code.github.io/facets/) project.

## Describing data with TFDV
The usual workflow when using TFDV during training is as follows:
* Generate statistics for the data
* Use those statistics to generate a schema for each feature
* Visualize the schema and statistics and manually inspect them
* Update the schema if needed

Then when new data comes in, the workflow becomes:
* Generate statistics and schema for the new data.
* Visualize side by side the statistics to the training data statistics.
* Validate the statistics against the one from training to detect anomalies.


### Generating Statistics
Before any data validation we need to generate statistics, we can use any of TFDV helper functions:
* `tfdv.generate_statistics_from_csv` when data is in a CSV file
* `tfdv.generate_statistics_from_dataframe` when data is in a Pandas DataFrame
* `tfdv.generate_statistics_from_tfrecord` when data is in a [TFRecord]({{ "dltips/en/tensorflow/tfrecord/" | absolute_url }}) file


Here is an example reading from a CSV file with TFDV and generating statistics for each feature.

```python
stats = tfdv.generate_statistics_from_csv(data_location='data/train.csv', delimiter=',')
```

We can manually inspect those statistics using `tfdv.visualize_statistics`
```python
tfdv.visualize_statistics(stats)
```

<iframe id="" width="100%" height="600px" srcdoc="<script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/webcomponentsjs/1.3.3/webcomponents-lite.js&quot;></script><link rel=&quot;import&quot; href=&quot;https://raw.githubusercontent.com/PAIR-code/facets/master/facets-dist/facets-jupyter.html&quot;><facets-overview proto-input=&quot;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&quot;></facets-overview>"></iframe>

You can notice that TFDV generates different types of statistics based on the type of features.

* For numerical features, TFDV computes for every feature:
  * Count of records
  * Number of missing (i.e. null values)
  * Histogram of values
  * Mean and standard deviation
  * Minimum and maximum values
  * Percentage of zero values

* For categorical features, TFDV provides:
  * Count of values
  * Percentage of missing values
  * Number of unique values
  * Average string length
  * Count for each label and its rank

### Generating Schema

Once statistics are generated, the next step is to generate a schema for our dataset. This schema will map each feature in the dataset to a type (float, bytes, etc.). Also define feature boundaries (min, max, distribution of values and missings, etc.).

With TFDV, we generate schema from statistincs using `tfdv.infer_schema` as follows:
```python
schema = tfdv.infer_schema(stats)
```

For example a numercial may have a schema like this:
```python
feature {
  name: "Num"
  type: FLOAT
  presence {
    min_fraction: 1.0
    min_count: 1
  }
  shape {
    dim {
      size: 1
    }
  }
}
```

On the other hand, a categorical feature may have a schema that looks like this:
```python
feature {
  name: "Cat"
  type: BYTES
  domain: "Cat"
  presence {
    min_fraction: 1.0
    min_count: 1
  }
  shape {
    dim {
      size: 1
    }
  }
}
string_domain {
  name: "Cat"
  value: "A"
  value: "B"
  value: "C"
}
```

TFDV provides a API to print a summary of each feature schema using `tfdv.display_schema`
```python
tfdv.display_schema(schema)
```

|Feature name|Type|Presence|Valency|Domain|
|-|-|-|-|-|
|'Num'|FLOAT|required|| - |
|'Cat'|STRING|required||'Cat'|

|Domain||
| - | - |
|'Cat'| 'A', 'B', 'C' |


In this visualization, the columns stand for:
* **Presence** indicates whether the feature must be present in 100% of examples (*required*) or not (*optional*).
* **Valency** indicates the number of values required per training example. In the case of categorical features, *single* indicates that each training example must have exactly one category for the feature.

### Updating schema
TFDV lets you update the schema according to your domain knowledge of the data if you are not satisfied by the auto-generated schema.

The steps to update the schema are as follows:

First, load the schema from its serialized location:
```python
original_schema = tfdv.load_schema_text(schema_location)
```

Then, we update this feature, for instance so that it is required in 80% of cases instead of 100%:
```python
Num_feature = tfdv.get_feature(schema, 'Num')
Num_feature.presence.min_fraction = 0.8
```
Another case, would be if a categorical feature was missing possible value. We can add this new label as follows:
```python
Colors_domain = tfdv.get_domain(schema, 'Colors')
Colors_domain.value.insert(3, 'Yellow')
Colors_domain.value
# ['Red', 'Green', 'Blue', 'Yellow']
```

Finally, we can store the schema back as follows:
```python
tfdv.write_schema_text(schema, schema_location)
```

## Spotting issues with TFDV
In the previous sections, we introduced the basics of TFDV and how to generate statistics and a schema for a dataset. In this section, we will see how to use TFDV to spot issues in the data.

### Comparing Datasets
Suppose we have two datasets one for training the over for evaluation. TFDV lets you determine how representative is the evaluation dataset of to the training one. More precisely, it helps you answer questions like:
* Does the evaluation data have a similar schema as the training dataset?
* Does the distribution of values for every features matches in both datasets?

The following example, illustrate the interactive tool that TFDV provides for comparing two datasets:
```python
dataset1_stats = tfdv.generate_statistics_from_csv(
  data_location='data/X_1.csv', delimiter=',')
dataset2_stats = tfdv.generate_statistics_from_csv(
  data_location='data/X_2.csv', delimiter=',')

tfdv.visualize_statistics(
  lhs_statistics=dataset1_stats, lhs_name='DS-I',
  rhs_statistics=dataset2_stats, rhs_name='DS-II')
```

<iframe id="" width="100%" height="600px" srcdoc="<script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/webcomponentsjs/1.3.3/webcomponents-lite.js&quot;></script><link rel=&quot;import&quot; href=&quot;https://raw.githubusercontent.com/PAIR-code/facets/master/facets-dist/facets-jupyter.html&quot;><facets-overview proto-input=&quot;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&quot;></facets-overview>"></iframe>

In this example, we can easily see that the distribution of the two datasets is very different. In most cases, the same two follow a normal distribution but clearly with two different mean and standard deviation. We can also see that in the second dataset, the numerical feature **X4** has a lot more missing values than it does in the first dataset. Also, the categorical feature **X3** seem to have an additional label in the second dataset which is not present in the first dataset.


We can use the earlier generate schema for comparison and spot any mismatches present in the second dataset:
```python
anomalies = tfdv.validate_statistics(statistics=dataset2_stats, schema=schema, previous_statistics=dataset1_stats)
anomalies
```
An example of the output of the anomaly report
```
anomaly_info {
  key: "X3"
  value {
    description: "Examples contain values missing from the schema: D (~13%). "
    severity: ERROR
    short_description: "Unexpected string values"
    reason {
      type: ENUM_TYPE_UNEXPECTED_STRING_VALUES
      short_description: "Unexpected string values"
      description: "Examples contain values missing from the schema: D (~13%). "
    }
    path {
      step: "X3"
    }
  }
}
```

We can display a summary of the anomalies using `tfdv.display_anomalies`
```python
tfdv.display_anomalies(anomalies)
```

|Feature name | Anomaly short description | Anomaly long description|
| - | - | - |
|'X1'| Column dropped | The feature was present in fewer examples than expected.
|'X3'| Unexpected string values | Examples contain values missing from the schema: D (~13%).
|'X4'|Column dropped|The feature was present in fewer examples than expected.
|'X5'|Unexpected string values|Examples contain values missing from the schema: D (~16%).

We can see that the reported anomalies matches our earlier observations, for instance:
* The presence of a new label *D* for the categorical feature **X3**
* The higher rate of missing values for the feature **X4**



### Comparing slices
In addition to comparing entire datasets, TFDV can also be used to compare slices of the same dataset on a particular feature. This is very useful when inspecting the data for bias when missing values are not uniformly spread over the different labels.

As an example, we will look at feature **X3** from the first dataset, and slice this dataset to get the statistics for label *B* using the following snippet.


```python
from tensorflow_data_validation.utils import slicing_util

# slice dataset on label B of feature X3
slice_fn1 = slicing_util.get_feature_value_slicer(features={'X3': [b'B']})
slice_options = tfdv.StatsOptions(slice_functions=[slice_fn1])
slice_stats = tfdv.generate_statistics_from_csv(
  data_location='data/X_1.csv',
  stats_options=slice_options)

# helper code for visualization
from tensorflow_metadata.proto.v0 import statistics_pb2

def display_slice_keys(stats):
  print(list(map(lambda x: x.name, slice_stats.datasets)))

def get_sliced_stats(stats, slice_key):
  for sliced_stats in stats.datasets:
    if sliced_stats.name == slice_key:
      result = statistics_pb2.DatasetFeatureStatisticsList()
      result.datasets.add().CopyFrom(sliced_stats)
      return result
    print(f'Invalid Slicing key: {slice_key}')

# Visualize both statistics
lhs_stats = get_sliced_stats(slice_stats, 'X3_B')
rhs_stats = get_sliced_stats(slice_stats, 'All Examples')
tfdv.visualize_statistics(lhs_stats, rhs_stats)
```

The resulting TFDV visualization of the slice vs all dataset will look like this:

<iframe id="" width="100%" height="600px" srcdoc="<script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/webcomponentsjs/1.3.3/webcomponents-lite.js&quot;></script><link rel=&quot;import&quot; href=&quot;https://raw.githubusercontent.com/PAIR-code/facets/master/facets-dist/facets-jupyter.html&quot;><facets-overview proto-input=&quot;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&quot;></facets-overview>"></iframe>

### Comparing Datasets for Skew
TFDV provides `skew_comparator` to inspect the statistics of two datasets and detects any significant differences. TFDV defines Skew as the [L-infinity norm](https://en.wikipedia.org/wiki/L-infinity) of the difference between the `serving_statistics` of two datasets. A threshold on the L-infinity norm is used for reporting an anomaly.

The following example, illustrates how to generate the Skew anomaly report then visualize it.

```python
tfdv.get_feature(schema, 'X5').skew_comparator.infinity_norm.threshold = 0.01
skew_anomalies = tfdv.validate_statistics(
  statistics=dataset1_stats,
  schema=schema,
  serving_statistics=dataset2_stats)
skew_anomalies
```

After generating the Skew anomaly report, we can visualize it using `display_anomalies`
```python
tfdv.display_anomalies(skew_anomalies)
```

|Feature name|Anomaly short description|Anomaly long description|
| - | - | - |
|'X5' | High Linfty distance between training and serving | The Linfty distance between training and serving is 0.1648 (up to six significant digits), above the threshold 0.01. The feature value with maximum difference is: D|

### Comparing Datasets for Drift
TFDV also provides a `drift_comparator` for comparing the statistics of two datasets (e.g. collected at different months).

To use the `drift_comparator` as illustrated in the following snippet, simply pick a feature to analyze and use `validate_statistics` by supplying a baseline (e.g., last month dataset) and a comparison dataset (e.g., this month dataset).
```python
tfdv.get_feature(schema, 'X3').drift_comparator.infinity_norm.threshold = 0.01
drift_anomalies = tfdv.validate_statistics(
  statistics = dataset2_stats,
  schema = schema,
  previous_statistics = dataset1_stats)
drift_anomalies
```

After generating the Drift anomaly report, we can visualize it using `display_anomalies`

```python
tfdv.display_anomalies(skew_anomalies)
```

|Feature name| Anomaly short description | Anomaly long description|
| - | - | - |
|'X5' | High Linfty distance between training and serving | The Linfty distance between training and serving is 0.1648 (up to six significant digits), above the threshold 0.01. The feature value with maximum difference is: D|


## Using TFDV with TFX
In the previous sections, we have seen how to use TFDV for exploring and validation datasets as a standalone tool. This is very handy for manual inspection of the data, but this can also be automated in TFX using the following components:

### Generating statistics with StatisticsGen
For generating statistics, TFX provides the pipeline component `StatisticsGen`. This component accepts as input the output from the pipeline component `ExampleGen` components as input. It can be used as follows:

```python
from tfx.components import StatisticsGen

statistics_gen = StatisticsGen(
  examples=example_gen.outputs['examples'])
context.run(statistics_gen)
```
When TFX pipeline is run in an interactive context, we can visualize the output statistics using Facets as follows:
```python
context.show(statistics_gen.outputs['statistics'])
```

### Generating Schema with SchemaGen
For generating schema for our data, TFX provides the `SchemaGen` component which takes as input the previously generting statistics by `StatisticsGen`.
```python
from tfx.components import SchemaGen

schema_gen = SchemaGen(
  statistics=statistics_gen.outputs['statistics'],
  infer_feature_shape=True)
context.run(schema_gen)
```

Note: if a schema already exists in the metadata store, the SchemaGen will not generate a new one and in case it has to be updated (e.g. due to the presence of a new feature) you may have to update it manually as explained earlier.

### Validating examples with ExampleValidator
For validating examples from a new datasets, TFX provides the `ExampleValidator` component which takes as input the output of the two previous component, i.e. the schema and statistics.
```python
from tfx.components import ExampleValidator

example_validator = ExampleValidator(
  statistics=statistics_gen.outputs['statistics'],
  schema=schema_gen.outputs['schema'])
context.run(example_validator)
```

Note: in case of any anomalies detected by the `ExampleValidator` component (i.e. mismatches in statistics or schema) it will set the status of the pipeline in the metadata store to failed, which will eventually stop it. Otherwise, the pipeline will proceed, for instance to the data preprocessing step.